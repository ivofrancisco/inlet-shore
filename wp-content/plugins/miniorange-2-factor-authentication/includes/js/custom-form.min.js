jQuery(document).ready(function(){let t=jQuery,e=otpverificationObj.siteURL,i=otpverificationObj.nonce,o=otpverificationObj.submitSelector,n=otpverificationObj.formSubmit,a=otpverificationObj.formname,r=otpverificationObj.emailselector,s=otpverificationObj.phoneSelector,l=otpverificationObj.notificationSelector,c=otpverificationObj.successClass,d=otpverificationObj.errorClass,p="",f="",b=!1,u=!1,v=otpverificationObj.authType,_=otpverificationObj.isEnabledShortcode,g=otpverificationObj.isRegistered;const m='<input type="text"name="edit_otp"id="edit_otp"placeholder="Enter OTP"style="display:none; ">',h='<p id="otpmessage">'+otpverificationStringsObj.otp_sent_phone+"</p>",O='<p id="otpmessage">'+otpverificationStringsObj.otp_sent_both+"</p>",j='<p id="otpmessage">'+otpverificationStringsObj.otp_sent_email+"</p>",S='<button type="button" class="button" id ="otp_send_button">'+otpverificationStringsObj.send_otp+'</button> <div class="button" id ="timer" style="display:none;margin-top:1em">00</div>',y='<button type="button" class="button" id ="validate_otp" style="display:none;margin-top:1em">'+otpverificationStringsObj.validate_otp+"</button><br>",x=(otpverificationStringsObj.phone_num,document.createElement("style"));if(x.innerHTML="\n\t\t\t  .mo2f_red {\n\t\t\t\tcolor:red;\n\t\t\t  }\n\t\t\t  .mo2f_green {\n\t\t\t\tcolor:green;\n\t\t\t  }\n\t\t\t",document.head.appendChild(x),"false"===g){const e='<p id="registermessage" style="color: red;font-size: 18px;border: red 1px solid;padding: 5px" > '+otpverificationStringsObj.account_register+"</p>";t(r).after("<br>"+e)}else if((t(a).length||t(o).length)&&!1!==g&&"false"!==_){function k(t,e){C(otpverificationStringsObj[t],e)}function C(e,i){var o=t(l).offset();t(l).text(""),"red"==i?(t(l).text(e).removeClass(c).css("display","block").addClass(d),window.location.href=l,0!=o.top&&window.scroll({top:o.top-.25*screen.height,behavior:"smooth"})):t(l).text(e).css("display","block").removeClass(d).addClass(c)}function E(e,i,o,n,a){p="";let r,s=0,l={action:"mo_shortcode",mo_action:"challenge",email:o,phone:i,nonce:n,authTypeSend:e};t("#otp_send_button").text(otpverificationStringsObj.sending_otp),t.post(a,l,function(e){if(e.status,null===e)k("contact_admin","red");else switch(e.status){case"SUCCESS":function a(){0===s?(clearTimeout(r),t("#otp_send_button").css("display","block"),t("#timer").css("display","none"),t("#otp_send_button").text(otpverificationStringsObj.resend_otp)):(t("#timer").css("display","block"),t("#otp_send_button").css("display","none"),t("#timer").text(s),s--)}t("#edit_otp").css("display","block"),t("#validate_otp").css("display","block"),C(e.message,"green"),p=e.txId,u?clearInterval(r):s=30,t("#validate_otp").click(function(e){e.preventDefault(),x=t("#edit_otp").val(),R(x,n,i,p,o)}),r=setInterval(a,1e3);break;case"FAILED":case"ERROR":t("#otp_send_button").text(otpverificationStringsObj.send_otp),C(e.message,"red")}})}function R(i,a,r,s,l){let c={action:"mo_shortcode",mo_action:"validate",otp:i,nonce:a,mobile:r,txId:s,email:l};!1===b&&t.post(e,c,function(e){if(null===e)k("validation_error","red"),b=!1;else switch(e.status){case"SUCCESS":return C(e.message,"green"),b=!0,".ur-submit-button"===o&&setTimeout(function(){location.reload()},15e3),"true"==n?t(o).unbind("click").click():t(o).unbind("click"),!0;case"FAILED":return C(e.message,"red"),t(o).removeAttr("disabled"),!1;case"ERROR":return t(o).removeAttr("disabled"),!1}})}function I(i,n,a,r,s,l){let c={action:"mo_shortcode",mo_action:"validate",otp:i,nonce:n,mobile:a,txId:r,email:s};!1===b?l&&t.post(e,c,function(r){if(l=!1,null===r)k("validation_error","red"),b=!1;else switch(r.status){case"SUCCESS":C(a+" "+r.message+" "+otpverificationStringsObj.sending_otp+s,"green"),b=!1,u=!0,setTimeout(function(){E("email",null,s,n,e)},3e3),t("#edit_otp").val(""),t("#edit_otp").css("placeholder",otpverificationStringsObj.enter_otp),t("#reg_phone").after('<br><p style="color:green;">'+otpverificationStringsObj.phone_validated+"</p>"),t("#reg_phone").attr("disabled","true"),t(o).text(otpverificationStringsObj.register),t(o).click(function(e){0==b&&(e.preventDefault(),i=t("#edit_otp").val(),R(i,n,a,f,s))});break;case"FAILED":case"ERROR":C(r.message,"red")}}):(k("already_validated","red"),jQuery.reload())}let _,g,x;switch(v){case"phone":if(!t(s).length){const e='<p id="phoneFieldLabel" style="color: red;font-size: 18px;border: red 1px solid;padding: 5px" >'+otpverificationStringsObj.phone_field_not_found+"</p>";return void t(r).after("<br>"+e)}t(s).after(h+m+S+y),t(s).intlTelInput({}),t("#otp_send_button").click(function(){_=t(s).val(),_=_.replace(/\s+/g,""),g=t(r).val(),w(_)?T(g)?(u=!1,E(v,_,null,i,e)):k("invalid_email","red"):k("invalid_phone","red")}),t(o).click(function(e){e.preventDefault(),!1===b&&(x=t("#edit_otp").val(),x?R(x,i,_,p,g):k("validate_phone","red"))});break;case"email":t("#reg_passmail").length&&(t("#reg_passmail").css("visibility","hidden"),t(".clear").remove());let n=t(r).attr("class");t("#edit_otp").addClass(n);let l=t(o).attr("class");if(t("#otp_send_button").attr("class",l),!t(r).length){const e='<p id="emailFieldLabel" style="color: red;font-size: 18px;border: red 1px solid;padding: 5px" > '+otpverificationStringsObj.email_field+r+otpverificationStringsObj.not_found+"</p>";return void(t(a).length?t(a).after("<br>"+e):t(o).length&&t(o).after("<br>"+e))}t(r).after(j+m+S+y),t("#otp_send_button").click(function(){g=t(r).val(),T(g)?(u=!1,E(v,null,g,i,e)):k("invalid_email","red")}),t(o).click(function(e){e.preventDefault(),!1===b&&(x=t("#edit_otp").val(),x?R(x,i,_,p,g):k("validate_email","red"))});break;case"both":if(t(r).after("<br>"+O+m+S+y),t(s).intlTelInput({}),!t(s).length){const e='<p id="phoneFieldLabel" style="color: red;font-size: 18px;border: red 1px solid;padding: 5px" > '+otpverificationStringsObj.phone_field_not_found+"</p>";return void t(r).after("<br>"+e)}t("#otp_send_button").click(function(){_=t(s).val(),_=_.replace(/\s+/g,""),g=t(r).val(),w(_)?T(g)?(u?(E("email",null,g,i,e),t(o).text(otpverificationStringsObj.register)):E("phone",_,null,i,e),t(o).text(otpverificationStringsObj.validate_otp)):k("invalid_email","red"):k("invalid_phone","red")}),t(o).click(function(e){e.preventDefault(),!1===b&&(g=t(r).val(),x=t("#edit_otp").val(),x&&g?I(x,i,_,p,g,!0):k("validate_both","red"))})}function T(t){let e=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i;return!!e.test(t)}function w(t){let e=/[0-9 -()+]+$/;return!(t.length<10||0==t.length||!e.test(t))}}});